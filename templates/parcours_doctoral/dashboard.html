{% extends "bootstrap5/layout.html" %}
{% load bootstrap3 i18n osis_role pagination static enums parcours_doctoral %}

{% comment "License" %}
  * OSIS stands for Open Student Information System. It's an application
  * designed to manage the core business of higher education institutions,
  * such as universities, faculties, institutes and professional schools.
  * The core business involves the administration of students, teachers,
  * courses, programs and so on.
  *
  * Copyright (C) 2015-2024 Universit√© catholique de Louvain (http://www.uclouvain.be)
  *
  * This program is free software: you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
  * the Free Software Foundation, either version 3 of the License, or
  * (at your option) any later version.
  *
  * This program is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  * GNU General Public License for more details.
  *
  * A copy of this license - GNU General Public License - is available
  * at the root of the source code of this program.  If not,
  * see http://www.gnu.org/licenses/.
{% endcomment %}

{% block breadcrumb %}
  <li class="breadcrumb-item">
    <a href="{% url 'studies' %}" id="lnk_studies">{% translate 'Student path' %}</a>
  </li>
  <li class="breadcrumb-item" id="lnk_cohorts_management">
    <a href="{% url 'cohorts_management' %}">{% translate "Cohorts management" %}</a>
  </li>
  <li class="breadcrumb-item">
    <a href="{% url 'parcours_doctoral:list' %}" id="lnk_parcours_doctorals">
      {% trans 'Doctoral trainings' %}
    </a>
  </li>
  <li class="breadcrumb-item active">
    {% translate 'Dashboard' %}
  </li>
{% endblock %}

{% block content %}
  <div class="page-header">
    <h2 class="d-inline-block">{% trans "Dashboard" %}</h2>
  </div>

  <div class="row">
    {% url 'admission:doctorate:cdd:list' as admission_url %}
    {% url 'parcours_doctoral:list' as doctorate_url %}
    {% for category in dashboard.categories.values %}
      <div class="col mb-3">
        <div class="card card-default h-100">
          <div class="card-heading fw-bold">
            {{ category.libelle }}
          </div>
          <div class="card-body">
            <table class="table border">
              {% for indicator in category.indicateurs.values %}
                <tr class="{% if indicator.valeur == None %}pe-none opacity-50{% endif %}">
                  <td class="text-nowrap align-middle">
                    {{ indicator.libelle }}
                  </td>
                  <td class="text-end min-width">
                    <div class="d-inline-flex p-0 w-100">
                      <span class="bg-info text-white px-2 py-1 flex-1">
                        {{ indicator.valeur|default_if_none:'WIP' }}
                      </span>
                      <a
                        {% if category.type == 'ADMISSION' %}
                        href="{{ admission_url }}?indicateur_tableau_bord={{ indicator.id }}"
                        {% elif category.type == 'DOCTORAT' %}
                        href="{{ doctorate_url }}?date_form-TOTAL_FORMS=0&date_form-INITIAL_FORMS=0&indicateur_tableau_bord={{ indicator.id }}"
                        {% endif %}
                        title="{% translate 'Open the related list' %}"
                        class="btn btn-default px-2 py-1 border border-start-0 rounded-0"
                      >
                        <i class="fa-solid fa-list"></i>
                      </a>
                    </div>
                  </td>
                </tr>
              {% endfor %}
            </table>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}

{% block style %}

  {{ block.super }}

  <link rel="stylesheet" href="{% static 'parcours_doctoral/parcours_doctoral.css' %}" type='text/css'>
{% endblock %}
